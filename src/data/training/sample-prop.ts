import type { TrainingQuestion } from './types';

const questions: TrainingQuestion[] = [
  // Level 1
  {
    id: 'sample-prop-l1-1',
    nodeId: 'sample-prop',
    level: 1,
    title: 'Sample Proportion Definition',
    text: 'In a random sample of 80 people, 28 are left-handed. What is the sample proportion $\\hat{p}$?',
    hints: ['$\\hat{p} = \\frac{\\text{number of successes}}{n}$'],
    answer: '$\\hat{p} = \\frac{28}{80} = 0.35$',
    marks: 1,
  },
  {
    id: 'sample-prop-l1-2',
    nodeId: 'sample-prop',
    level: 1,
    title: 'Mean of Sample Proportion',
    text: 'If the true population proportion is $p = 0.6$ and samples of size $n = 50$ are taken, what is the expected value of $\\hat{p}$?',
    hints: ['$E(\\hat{p}) = p$'],
    answer: '$E(\\hat{p}) = p = 0.6$',
    marks: 1,
    isMultipleChoice: true,
    options: [
      { label: 'A', text: '$0.5$', correct: false },
      { label: 'B', text: '$0.6$', correct: true },
      { label: 'C', text: '$0.012$', correct: false },
      { label: 'D', text: '$30$', correct: false },
    ],
  },
  {
    id: 'sample-prop-l1-3',
    nodeId: 'sample-prop',
    level: 1,
    title: 'Standard Error of Sample Proportion',
    text: 'If $p = 0.4$ and $n = 100$, find the standard deviation (standard error) of the sampling distribution of $\\hat{p}$.',
    hints: ['$\\text{SD}(\\hat{p}) = \\sqrt{\\frac{p(1-p)}{n}}$'],
    answer: '$\\text{SD}(\\hat{p}) = \\sqrt{\\frac{0.4 \\times 0.6}{100}} = \\sqrt{0.0024} = 0.0490$',
    marks: 2,
  },
  {
    id: 'sample-prop-l1-4',
    nodeId: 'sample-prop',
    level: 1,
    title: 'Normal Approximation Conditions',
    text: 'For which of the following can the sampling distribution of $\\hat{p}$ be approximated by a normal distribution?',
    hints: ['Check $np \\geq 10$ and $n(1-p) \\geq 10$'],
    answer: '$n = 50$, $p = 0.3$: $np = 15 \\geq 10$, $n(1-p) = 35 \\geq 10$. âœ“',
    marks: 2,
    isMultipleChoice: true,
    options: [
      { label: 'A', text: '$n = 10$, $p = 0.5$', correct: false },
      { label: 'B', text: '$n = 20$, $p = 0.02$', correct: false },
      { label: 'C', text: '$n = 50$, $p = 0.3$', correct: true },
      { label: 'D', text: '$n = 15$, $p = 0.9$', correct: false },
    ],
  },
  // Level 2
  {
    id: 'sample-prop-l2-1',
    nodeId: 'sample-prop',
    level: 2,
    title: 'Probability Involving Sample Proportion',
    text: 'A population has $p = 0.25$. A random sample of $n = 200$ is taken. Find $\\Pr(\\hat{p} > 0.30)$.',
    hints: [
      '$\\hat{p} \\sim N\\left(0.25, \\frac{0.25 \\times 0.75}{200}\\right)$ approximately',
      '$\\text{SD}(\\hat{p}) = \\sqrt{\\frac{0.1875}{200}}$',
    ],
    answer: '$\\text{SD} = \\sqrt{\\frac{0.1875}{200}} = 0.03062$. $z = \\frac{0.30 - 0.25}{0.03062} = 1.633$. $\\Pr(\\hat{p} > 0.30) = 1 - \\Phi(1.633) \\approx 1 - 0.9487 = 0.0513$',
    marks: 3,
  },
  {
    id: 'sample-prop-l2-2',
    nodeId: 'sample-prop',
    level: 2,
    title: 'Central Limit Theorem for Proportions',
    text: '35% of a city\'s residents cycle to work. In a random sample of 150 residents, what is the probability that between 30% and 40% of the sample cycle to work?',
    hints: [
      'Standardise both 0.30 and 0.40 using $\\text{SD}(\\hat{p}) = \\sqrt{\\frac{0.35 \\times 0.65}{150}}$',
    ],
    answer: '$\\text{SD} = \\sqrt{\\frac{0.2275}{150}} = 0.03894$. $z_1 = \\frac{0.30-0.35}{0.03894} = -1.284$, $z_2 = \\frac{0.40-0.35}{0.03894} = 1.284$. $\\Pr = \\Phi(1.284) - \\Phi(-1.284) = 0.9003 - 0.0997 = 0.8006 \\approx 0.80$',
    marks: 3,
  },
  {
    id: 'sample-prop-l2-3',
    nodeId: 'sample-prop',
    level: 2,
    title: 'Effect of Sample Size on Spread',
    text: 'For $p = 0.5$, calculate the standard error of $\\hat{p}$ for $n = 25$, $n = 100$, and $n = 400$. What pattern do you observe?',
    hints: ['Compute $\\sqrt{\\frac{0.25}{n}}$ for each value of $n$'],
    answer: '$n=25$: $\\text{SE} = \\frac{0.5}{5} = 0.100$. $n=100$: $\\text{SE} = \\frac{0.5}{10} = 0.050$. $n=400$: $\\text{SE} = \\frac{0.5}{20} = 0.025$. Each time $n$ is multiplied by 4, the SE is halved. SE decreases as $\\frac{1}{\\sqrt{n}}$.',
    marks: 3,
  },
  {
    id: 'sample-prop-l2-4',
    nodeId: 'sample-prop',
    level: 2,
    title: 'Using the Sampling Distribution',
    text: 'A manufacturer claims 95% of products pass quality control. In a sample of 300, 276 pass. Is this consistent with the claim? Find the probability of observing $\\hat{p} \\leq 0.92$.',
    hints: [
      'Under $H_0: p = 0.95$, $\\text{SD}(\\hat{p}) = \\sqrt{\\frac{0.95 \\times 0.05}{300}}$',
    ],
    answer: '$\\hat{p} = 276/300 = 0.92$. $\\text{SD} = \\sqrt{\\frac{0.0475}{300}} = 0.01258$. $z = \\frac{0.92 - 0.95}{0.01258} = -2.384$. $\\Pr(\\hat{p} \\leq 0.92) = \\Phi(-2.384) \\approx 0.0086$. This is very unlikely under the claim; evidence against $p = 0.95$.',
    marks: 3,
  },
  // Level 3
  {
    id: 'sample-prop-l3-1',
    nodeId: 'sample-prop',
    level: 3,
    title: 'Difference of Two Proportions',
    text: 'In Group A ($n_A = 200$), $\\hat{p}_A = 0.65$. In Group B ($n_B = 250$), $\\hat{p}_B = 0.58$. Find the standard error of $\\hat{p}_A - \\hat{p}_B$ and a 95% CI for $p_A - p_B$.',
    hints: [
      '$\\text{SE} = \\sqrt{\\frac{\\hat{p}_A(1-\\hat{p}_A)}{n_A} + \\frac{\\hat{p}_B(1-\\hat{p}_B)}{n_B}}$',
    ],
    answer: '$\\text{SE} = \\sqrt{\\frac{0.65 \\times 0.35}{200} + \\frac{0.58 \\times 0.42}{250}} = \\sqrt{0.001138 + 0.000974} = \\sqrt{0.002112} = 0.04596$. $\\hat{p}_A - \\hat{p}_B = 0.07$. CI: $0.07 \\pm 1.96 \\times 0.04596 = (-0.020, 0.160)$.',
    marks: 4,
  },
  {
    id: 'sample-prop-l3-2',
    nodeId: 'sample-prop',
    level: 3,
    title: 'Sampling Without Replacement',
    text: 'A town has 2000 residents, 800 of whom support a new park. A sample of 100 is drawn without replacement. Find $E(\\hat{p})$ and $\\text{SD}(\\hat{p})$ including the finite population correction.',
    hints: [
      '$\\text{SD}(\\hat{p}) = \\sqrt{\\frac{p(1-p)}{n}} \\times \\sqrt{\\frac{N-n}{N-1}}$',
    ],
    answer: '$p = 0.4$. $E(\\hat{p}) = 0.4$. $\\text{SD} = \\sqrt{\\frac{0.24}{100}} \\times \\sqrt{\\frac{1900}{1999}} = 0.04899 \\times 0.9752 = 0.04777$.',
    marks: 4,
  },
  {
    id: 'sample-prop-l3-3',
    nodeId: 'sample-prop',
    level: 3,
    title: 'Hypothesis Test for a Proportion',
    text: 'A company claims at least 70% of customers are satisfied. A survey of 150 customers finds 96 satisfied. Test $H_0: p = 0.70$ vs $H_1: p < 0.70$ at $\\alpha = 0.05$.',
    hints: [
      '$\\hat{p} = 96/150 = 0.64$. Compute the test statistic $z = \\frac{\\hat{p} - p_0}{\\sqrt{p_0(1-p_0)/n}}$',
      'Compare with $z_{0.05} = -1.645$ for a one-tailed test',
    ],
    answer: '$z = \\frac{0.64 - 0.70}{\\sqrt{\\frac{0.70 \\times 0.30}{150}}} = \\frac{-0.06}{0.03742} = -1.603$. Since $-1.603 > -1.645$, we do not reject $H_0$ at the 5% level. There is insufficient evidence that satisfaction is below 70%.',
    marks: 4,
  },
  // Level 4
  {
    id: 'sample-prop-l4-1',
    nodeId: 'sample-prop',
    level: 4,
    title: 'Power of a Proportion Test',
    text: 'Testing $H_0: p = 0.5$ vs $H_1: p > 0.5$ at $\\alpha = 0.05$ with $n = 100$. Find the power of the test if the true proportion is $p = 0.6$.',
    hints: [
      'The rejection region is $\\hat{p} > 0.5 + 1.645 \\times \\sqrt{0.25/100}$',
      'Find $\\Pr(\\hat{p} > c | p = 0.6)$',
    ],
    answer: 'Critical value: $c = 0.5 + 1.645 \\times 0.05 = 0.5823$. Under $p = 0.6$: $\\text{SD} = \\sqrt{\\frac{0.6 \\times 0.4}{100}} = 0.04899$. $z = \\frac{0.5823 - 0.6}{0.04899} = -0.362$. Power $= \\Pr(Z > -0.362) = 0.6414 \\approx 0.64$.',
    marks: 5,
  },
  {
    id: 'sample-prop-l4-2',
    nodeId: 'sample-prop',
    level: 4,
    title: 'Pooled Proportion Test',
    text: 'Test whether two populations have the same proportion. Sample 1: $n_1 = 120$, $x_1 = 48$. Sample 2: $n_2 = 150$, $x_2 = 72$. Use a two-sided test at $\\alpha = 0.05$.',
    hints: [
      'Pooled proportion: $\\hat{p} = \\frac{x_1+x_2}{n_1+n_2}$',
      '$z = \\frac{\\hat{p}_1 - \\hat{p}_2}{\\sqrt{\\hat{p}(1-\\hat{p})(\\frac{1}{n_1}+\\frac{1}{n_2})}}$',
    ],
    answer: '$\\hat{p}_1 = 0.4$, $\\hat{p}_2 = 0.48$. $\\hat{p} = \\frac{120}{270} = 0.4444$. $SE = \\sqrt{0.4444 \\times 0.5556 \\times (\\frac{1}{120}+\\frac{1}{150})} = \\sqrt{0.2469 \\times 0.01500} = \\sqrt{0.003704} = 0.06086$. $z = \\frac{0.4 - 0.48}{0.06086} = -1.314$. $|z| = 1.314 < 1.96$. Do not reject $H_0$; no significant difference.',
    marks: 5,
  },
  {
    id: 'sample-prop-l4-3',
    nodeId: 'sample-prop',
    level: 4,
    title: 'Sample Size for Power',
    text: 'For testing $H_0: p = 0.3$ vs $H_1: p = 0.4$ at $\\alpha = 0.05$ (one-sided), find the sample size needed for power $= 0.80$.',
    hints: [
      '$n = \\left(\\frac{z_\\alpha \\sqrt{p_0 q_0} + z_\\beta \\sqrt{p_1 q_1}}{p_1 - p_0}\\right)^2$',
      '$z_{0.05} = 1.645$, $z_{0.20} = 0.842$',
    ],
    answer: '$n = \\left(\\frac{1.645\\sqrt{0.21} + 0.842\\sqrt{0.24}}{0.1}\\right)^2 = \\left(\\frac{1.645 \\times 0.4583 + 0.842 \\times 0.4899}{0.1}\\right)^2 = \\left(\\frac{0.7539 + 0.4125}{0.1}\\right)^2 = (11.664)^2 = 136.1$. Round up: $n = 137$.',
    marks: 5,
  },
  // Level 5
  {
    id: 'sample-prop-l5-1',
    nodeId: 'sample-prop',
    level: 5,
    title: 'Delta Method for Transformed Proportion',
    text: 'Let $\\hat{p}$ be a sample proportion with $\\hat{p} \\sim N(p, \\frac{p(1-p)}{n})$ approximately. Using the delta method, find the approximate distribution of $g(\\hat{p}) = \\ln\\left(\\frac{\\hat{p}}{1-\\hat{p}}\\right)$ (the log-odds).',
    hints: [
      'Delta method: $g(\\hat{p}) \\approx N\\left(g(p),\\, [g\'(p)]^2 \\cdot \\frac{p(1-p)}{n}\\right)$',
      '$g\'(p) = \\frac{1}{p(1-p)}$',
    ],
    answer: '$g\'(p) = \\frac{1}{p} + \\frac{1}{1-p} = \\frac{1}{p(1-p)}$. $[g\'(p)]^2 \\cdot \\frac{p(1-p)}{n} = \\frac{1}{[p(1-p)]^2} \\cdot \\frac{p(1-p)}{n} = \\frac{1}{np(1-p)}$. So $\\ln\\left(\\frac{\\hat{p}}{1-\\hat{p}}\\right) \\sim N\\left(\\ln\\left(\\frac{p}{1-p}\\right),\\, \\frac{1}{np(1-p)}\\right)$ approximately.',
    marks: 6,
  },
  {
    id: 'sample-prop-l5-2',
    nodeId: 'sample-prop',
    level: 5,
    title: 'Berry-Esseen Bound Application',
    text: 'For $\\hat{p}$ based on $n$ i.i.d. Bernoulli($p$) trials, the Berry-Esseen theorem states $\\sup_x \\left|\\Pr\\left(\\frac{\\hat{p}-p}{\\sqrt{p(1-p)/n}} \\leq x\\right) - \\Phi(x)\\right| \\leq \\frac{C\\rho}{\\sigma^3 \\sqrt{n}}$ where $\\rho = E|X_i - p|^3$. For $p = 0.5$, compute $\\rho/\\sigma^3$ and find the minimum $n$ such that the bound is at most 0.01 (using $C = 0.4748$).',
    hints: [
      'For Bernoulli($0.5$): $\\sigma^2 = 0.25$, $\\rho = E|X-0.5|^3 = 0.5 \\times 0.5^3 + 0.5 \\times 0.5^3$',
    ],
    answer: '$\\sigma^2 = 0.25$, $\\sigma^3 = 0.125$. $\\rho = E|X-0.5|^3 = 2 \\times 0.5 \\times (0.5)^3 = 0.125$. $\\frac{\\rho}{\\sigma^3} = 1$. Bound: $\\frac{0.4748}{\\sqrt{n}} \\leq 0.01 \\Rightarrow \\sqrt{n} \\geq 47.48 \\Rightarrow n \\geq 2255$.',
    marks: 6,
  },
];

export default questions;
